<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台語動物教學小遊戲</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.21.2/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fff5f0;
            background-image: linear-gradient(135deg, #fff9f5 0%, #fff2eb 100%);
            background-attachment: fixed;
            margin: 0;
            padding: 0;
            color: #33303a;
        }
        .quiz-container {
            max-width: 1000px;
            margin: 20px auto;
            box-shadow: 0 10px 30px rgba(255, 150, 100, 0.15);
            border-radius: 20px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 178, 142, 0.3);
        }
        .quiz-header {
            background: linear-gradient(90deg, #FF9664, #FFB28E);
            color: white;
            padding: 1.8rem;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 15px -5px rgba(255, 150, 100, 0.4);
        }
        .quiz-header h1 {
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        .quiz-header::after {
            content: "";
            position: absolute;
            bottom: -15px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 20px solid #FFB28E;
        }
        .question-card {
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(255, 150, 100, 0.08);
            border: 1px solid rgba(255, 178, 142, 0.2);
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .question-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(255, 150, 100, 0.12);
        }
        .question-title {
            color: #FF7F50;
            border-bottom: 2px solid rgba(255, 150, 100, 0.2);
        }
        .option-label {
            transition: all 0.2s;
            border-radius: 12px;
            padding: 0.7rem 1.2rem;
            margin: 0.3rem 0;
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 178, 142, 0.15);
        }
        .option-label:hover {
            background: rgba(255, 235, 225, 0.7);
            border: 1px solid rgba(255, 178, 142, 0.3);
        }
        .btn-watch-complete {
            background: linear-gradient(90deg, #FF5C3F, #FF7F50);
            color: white;
            transition: all 0.3s;
            transform: translateY(0);
            box-shadow: 0 6px 12px rgba(255, 92, 63, 0.3);
            font-size: 1.1rem;
            padding: 1rem 1.5rem;
            border-radius: 100px;
            text-align: center;
            font-weight: bold;
            display: block;
            width: 100%;
            margin-top: 20px;
            cursor: pointer;
            border: none;
            outline: none;
        }
        .btn-watch-complete:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 92, 63, 0.4);
            background: linear-gradient(90deg, #FF4D2E, #FF7043);
        }
        .btn-watch-complete:active {
            transform: translateY(1px);
        }
        .btn-submit {
            background: linear-gradient(90deg, #FF7F50, #FFAB76);
            color: white;
            transition: all 0.3s;
            transform: translateY(0);
            box-shadow: 0 6px 12px rgba(255, 127, 80, 0.3);
            font-size: 1.1rem;
            padding: 1rem 1.5rem;
            border-radius: 100px;
            text-align: center;
            font-weight: bold;
            display: block;
            width: 100%;
            cursor: pointer;
            border: none;
            outline: none;
        }
        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 127, 80, 0.4);
            background: linear-gradient(90deg, #FF7043, #FFA369);
        }
        .btn-submit:disabled {
            background: linear-gradient(90deg, #FFD4C2, #FFE6DB);
            color: #CC9E8A;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }
        .btn-retry {
            background: linear-gradient(90deg, #FF9D7D, #FFC4B0);
            color: white;
            transition: all 0.3s;
            transform: translateY(0);
            box-shadow: 0 6px 12px rgba(255, 157, 125, 0.3);
            font-size: 1.1rem;
            padding: 1rem 1.5rem;
            border-radius: 100px;
            text-align: center;
            font-weight: bold;
            display: block;
            width: 100%;
            cursor: pointer;
            border: none;
            outline: none;
        }
        .btn-retry:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 157, 125, 0.4);
            background: linear-gradient(90deg, #FF8E6E, #FFB5A1);
        }
        .video-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(255, 150, 100, 0.15);
            border: 3px solid rgba(255, 178, 142, 0.3);
        }
        .video-wrapper {
            position: relative;
            padding-top: 56.25%; /* 16:9 比例 */
            height: 0;
            overflow: hidden;
        }
        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
        .result-card {
            background: linear-gradient(145deg, rgba(255, 242, 235, 0.8), rgba(255, 235, 225, 0.8));
            border-left: 5px solid #FF9664;
            border-radius: 12px;
        }
        input[type="checkbox"], input[type="radio"] {
            transform: scale(1.3);
            margin-right: 12px;
            accent-color: #FF7F50;
        }
        .correct-answer {
            color: #FF7F50;
            font-weight: 600;
            background: rgba(255, 235, 225, 0.7);
            border-radius: 8px;
            padding: 8px 12px;
        }
        .incorrect-answer {
            color: #FF5C3F;
            font-weight: 600;
            background: rgba(255, 235, 225, 0.7);
            border-radius: 8px;
            padding: 8px 12px;
        }
        .quiz-footer {
            font-size: 0.8rem;
            color: #FF9D7D;
            text-align: center;
            padding: 1rem;
            background-color: rgba(255, 242, 235, 0.5);
            border-top: 1px solid rgba(255, 178, 142, 0.2);
        }
        .steps-title {
            color: #FF7F50;
            font-weight: bold;
            font-size: 1.3rem;
            margin-bottom: 1rem;
            display: inline-block;
            padding: 0.5rem 1rem;
            background: rgba(255, 235, 225, 0.5);
            border-radius: 100px;
            border: 2px solid rgba(255, 178, 142, 0.2);
        }
        @media (max-width: 640px) {
            .quiz-container {
                width: 95%;
                margin: 10px auto;
                border-radius: 16px;
            }
            .quiz-header {
                padding: 1.2rem;
            }
            .quiz-header h1 {
                font-size: 1.5rem;
            }
            .option-label {
                padding: 0.6rem 1rem;
            }
            .btn-watch-complete, .btn-submit, .btn-retry {
                font-size: 1rem;
                padding: 0.8rem 1.2rem;
            }
        }
    </style>
</head>
<body class="py-4 px-2">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const TaiwaneseAnimalQuiz = () => {
            const [videoWatched, setVideoWatched] = useState(false);
            const [answers, setAnswers] = useState({
                q1: [],
                q2: '',
                q3: '',
                q4: '',
                q5: ''
            });
            const [submitted, setSubmitted] = useState(false);
            const [result, setResult] = useState('');
            const [windowWidth, setWindowWidth] = useState(window.innerWidth);

            // 監聽視窗大小變化
            useEffect(() => {
                const handleResize = () => {
                    setWindowWidth(window.innerWidth);
                };

                window.addEventListener('resize', handleResize);
                return () => {
                    window.removeEventListener('resize', handleResize);
                };
            }, []);

            // 問題及選項
            const questions = {
                q1: {
                    question: '請問剛剛有哪些動物的台語教學？（可複選）',
                    options: ['斑馬', '麒麟', '長頸鹿', '猴子', '企鵝', '獅子', '老虎'],
                    type: 'checkbox',
                    correctAnswer: ['長頸鹿', '斑馬', '企鵝']
                },
                q2: {
                    question: '最先教的動物是？',
                    options: ['企鵝', '長頸鹿', '斑馬', '獅子'],
                    type: 'radio',
                    correctAnswer: '斑馬'
                },
                q3: {
                    question: '誇讚人深藏不漏的台語怎麼說？',
                    options: ['深藏不露', '大隻雞慢啼', '烏矸仔貯豆油', '金玉其外', '有錢開無路'],
                    type: 'radio',
                    correctAnswer: '烏矸仔貯豆油'
                },
                q4: {
                    question: '豬哥亮哪個動物的字不會寫？',
                    options: ['企鵝', '馬來貘', '斑馬', '麒麟', '長頸鹿'],
                    type: 'radio',
                    correctAnswer: '麒麟'
                },
                q5: {
                    question: '三重大學是什麼意思呢？',
                    options: ['三重的一所社區大學', '很會念書', '沒有讀書的意思', '有很多學問'],
                    type: 'radio',
                    correctAnswer: '沒有讀書的意思'
                }
            };

            const handleWatchComplete = () => {
                setVideoWatched(true);
                setTimeout(() => {
                    document.getElementById('questions-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            };

            const handleCheckboxChange = (questionId, option) => {
                setAnswers(prev => {
                    const newAnswers = { ...prev };
                    if (newAnswers[questionId].includes(option)) {
                        newAnswers[questionId] = newAnswers[questionId].filter(item => item !== option);
                    } else {
                        newAnswers[questionId] = [...newAnswers[questionId], option];
                    }
                    return newAnswers;
                });
            };

            const handleRadioChange = (questionId, option) => {
                setAnswers(prev => ({
                    ...prev,
                    [questionId]: option
                }));
            };

            const handleSubmit = () => {
                setSubmitted(true);
                
                // Check answers
                let correct = 0;
                
                // 檢查多選題 (q1)
                const q1Answer = answers.q1.sort().join(',');
                const q1Correct = questions.q1.correctAnswer.sort().join(',');
                if (q1Answer === q1Correct) correct++;
                
                // 檢查單選題 (q2-q5)
                ['q2', 'q3', 'q4', 'q5'].forEach(key => {
                    if (answers[key] === questions[key].correctAnswer) correct++;
                });
                
                if (correct === 5) {
                    setResult('恭喜你全部答對！成功過關！ 🎉');
                } else {
                    setResult(`你答對了 ${correct}/5 題，再試一次吧！ 💪`);
                }

                // 滾動到結果區域
                setTimeout(() => {
                    document.getElementById('result-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 300);
            };

            const resetQuiz = () => {
                setSubmitted(false);
                setResult('');
                setAnswers({
                    q1: [],
                    q2: '',
                    q3: '',
                    q4: '',
                    q5: ''
                });
                // 滾動到問題區域
                setTimeout(() => {
                    document.getElementById('questions-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            };

            // 檢查是否回答完所有問題
            const isAllAnswered = () => {
                return (
                    answers.q1.length > 0 &&
                    answers.q2 !== '' &&
                    answers.q3 !== '' &&
                    answers.q4 !== '' &&
                    answers.q5 !== ''
                );
            };

            // 根據螢幕寬度決定問題選項的欄位數
            const getColumnClass = () => {
                if (windowWidth < 768) {
                    return "grid-cols-1"; // 手機螢幕一欄
                } else {
                    return "grid-cols-2"; // 電腦螢幕兩欄
                }
            };

            return (
                <div className="quiz-container">
                    <div className="quiz-header">
                        <h1 className="text-3xl font-bold">台語動物教學小遊戲</h1>
                        <p className="mt-2 opacity-90">觀看影片，回答問題，測試你的台語能力！</p>
                    </div>
                    
                    <div className="p-5 md:p-8">
                        <div className="mb-10">
                            <div className="steps-title">步驟一：觀看影片</div>
                            <div className="video-container">
                                <div className="video-wrapper">
                                    <iframe 
                                        src="https://www.youtube.com/embed/StTvn9R6VME" 
                                        title="台語動物教學影片"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                        allowFullScreen
                                    ></iframe>
                                </div>
                            </div>
                            <button 
                                onClick={handleWatchComplete} 
                                className="btn-watch-complete"
                            >
                                👍 我已經看完影片了，開始答題！
                            </button>
                        </div>

                        {videoWatched && (
                            <div id="questions-section" className="mt-8 mb-6">
                                <div className="steps-title">步驟二：回答問題</div>
                                
                                <div className="space-y-6">
                                    {/* 問題 1: 多選題 */}
                                    <div className="question-card p-5 md:p-6">
                                        <h3 className="question-title block mb-4 font-bold text-lg pb-2">
                                            1. {questions.q1.question}
                                        </h3>
                                        <div className={`grid ${getColumnClass()} gap-2 mt-4`}>
                                            {questions.q1.options.map((option, index) => (
                                                <div key={index} className="option-label flex items-center">
                                                    <input
                                                        type="checkbox"
                                                        id={`q1-${index}`}
                                                        checked={answers.q1.includes(option)}
                                                        onChange={() => handleCheckboxChange('q1', option)}
                                                        disabled={submitted}
                                                        className="mr-3 h-5 w-5"
                                                    />
                                                    <label htmlFor={`q1-${index}`} className="cursor-pointer flex-grow text-lg">
                                                        {option}
                                                    </label>
                                                </div>
                                            ))}
                                        </div>
                                        {submitted && (
                                            <p className={`mt-4 ${answers.q1.sort().join(',') === questions.q1.correctAnswer.sort().join(',') ? 'correct-answer' : 'incorrect-answer'}`}>
                                                {answers.q1.sort().join(',') === questions.q1.correctAnswer.sort().join(',') 
                                                    ? '✓ 正確！' 
                                                    : `✗ 正確答案：${questions.q1.correctAnswer.join('、')}`}
                                            </p>
                                        )}
                                    </div>
                                    
                                    {/* 問題 2-5: 單選題 */}
                                    {['q2', 'q3', 'q4', 'q5'].map((qId, qIndex) => (
                                        <div key={qId} className="question-card p-5 md:p-6">
                                            <h3 className="question-title block mb-4 font-bold text-lg pb-2">
                                                {qIndex + 2}. {questions[qId].question}
                                            </h3>
                                            <div className="grid grid-cols-1 gap-2 mt-4">
                                                {questions[qId].options.map((option, index) => (
                                                    <div key={index} className="option-label flex items-center">
                                                        <input
                                                            type="radio"
                                                            id={`${qId}-${index}`}
                                                            name={qId}
                                                            checked={answers[qId] === option}
                                                            onChange={() => handleRadioChange(qId, option)}
                                                            disabled={submitted}
                                                            className="mr-3 h-5 w-5"
                                                        />
                                                        <label htmlFor={`${qId}-${index}`} className="cursor-pointer flex-grow text-lg">
                                                            {option}
                                                        </label>
                                                    </div>
                                                ))}
                                            </div>
                                            {submitted && (
                                                <p className={`mt-4 ${answers[qId] === questions[qId].correctAnswer ? 'correct-answer' : 'incorrect-answer'}`}>
                                                    {answers[qId] === questions[qId].correctAnswer
                                                        ? '✓ 正確！'
                                                        : `✗ 正確答案：${questions[qId].correctAnswer}`}
                                                </p>
                                            )}
                                        </div>
                                    ))}
                                    
                                    <div id="result-section" className="mt-8">
                                        {!submitted ? (
                                            <button 
                                                onClick={handleSubmit} 
                                                disabled={!isAllAnswered()}
                                                className={isAllAnswered() ? 'btn-submit' : 'btn-submit disabled'}
                                            >
                                                {isAllAnswered() ? '📝 提交答案' : '⚠️ 請回答所有問題'}
                                            </button>
                                        ) : (
                                            <div className="result-card p-6 rounded-lg my-6">
                                                <p className="text-xl font-bold text-center p-3 rounded text-orange-600">
                                                    {result}
                                                </p>
                                                <button 
                                                    onClick={resetQuiz}
                                                    className="btn-retry mt-4"
                                                >
                                                    🔄 再試一次
                                                </button>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                    
                    <div className="quiz-footer">
                        台語動物教學小遊戲 © 2025
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<TaiwaneseAnimalQuiz />);
    </script>
</body>
</html>
